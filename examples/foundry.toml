[build]
dockerfile = "Dockerfile"
context = "."
timeout = 1800

[triggers]
branches = ["main", "master", "develop"]
pull_requests = true
# pr_target_branches = ["main"]  # Only build PRs targeting main

[[stages]]
name = "install"
command = "npm ci"

[[stages]]
name = "lint"
command = "npm run lint"
allow_failure = true

[[stages]]
name = "test"
command = "npm test"

[[stages]]
name = "build"
command = "npm run build"

[deploy]
name = "my-app"
domain = "myapp.l3s.me"
port = 3000

[schedule]
cron = "0 0 * * *"  # Run daily at midnight UTC
branch = "main"
enabled = true
timezone = "UTC"

[env]
NODE_ENV = "production"
